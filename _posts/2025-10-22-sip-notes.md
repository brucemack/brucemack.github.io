---
title: Notes on SIP
---

## RTP Port Traversal Examination

In this testing I used a properly configured SIP phone (.225) and an Asterisk 
server (.102).

Commands used to check firewall:

        sudo firewall-cmd --get-active-zones
        sudo firewall-cmd --zone=public --list-all
        sudo firewall-cmd --zone=allstarlink --list-all

The last command shows that a custom--sip rule had been added, which likely opens
port 5060 for inbound connections from the phone.

The SIP negotiation happens on UDP port 5060 without any problems.

The final message in the SIP negotiation (OK (INVITE)) assigns UDP port 16314 
to the RTP/media. That is a random server-assigned port inside of the expected 
range of 10,000 to 20,000.

![Capture 2](/assets/images/sip-capture-2.jpg)

However, that port is **normally 
not open to inbound connections**. Notice the ICMP messages being generated to 
tell the phone that its RTP messages are being rejected.

![Capture 1](/assets/images/sip-capture-1.jpg)
